#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <limits.h>

#define INITIAL_SIZE 101
#define LOAD_FACTOR 0.75

typedef struct Node {
  char *key;
  int value;
  struct Node *next;
} Node;

typedef struct map {
  Node **table;
  int capacity;
  int size;
} hashmap;

hashmap *createMap() {
  hashmap *newMap = (hashmap *)malloc(sizeof(hashmap));
  newMap->capacity = INITIAL_SIZE;
  newMap->size = 0;
  newMap->table = calloc(newMap->capacity, sizeof(Node *));
  return newMap;
}

Node *createNode(char *key, int value) {
  Node *newNode = (Node *)malloc(sizeof(Node));
  newNode->key = strdup(key);
  newNode->value = value;
  newNode->next = NULL;
  return newNode;  
}

unsigned long hash(char *key, int capacity) {
  unsigned long index = 5381;
  int c;
  while ((c = *key++)) {
    index = ((index << 5) + index) + c;
  }
  return index % capacity;
}

void insertNode(hashmap *map, char *key, int data) {
  unsigned long index = hash(key, map->capacity);
  Node *entry = map->table[index];
  while (entry) {
    if (strcmp(entry->key, key) == 0) {
      entry->value = data;
      return;
    }
    entry = entry->next;
  }
  Node *new = createNode(key, data);
  new->next = map->table[index];
  map->table[index] = new;
}

int lookUpByData(hashmap *map, char *key) {
  unsigned long index = hash(key, map->capacity);
  Node *entry = map->table[index];
  while (entry) {
    if (strcmp(entry->key, key) == 0) {
      return entry->value;
    }
    entry = entry->next;
  }
  return INT_MIN;  
}  
void freeMap(hashmap *map) {
  for (int i = 0; i < map->capacity; i++) {
    Node *entry = map->table[i];
    while (entry) {
      Node *temp = entry->next;
      free(entry->key);
      free(entry);
      entry = temp;      
    }
  }
  free(map->table);
  free(map);
}

void displayMap(hashmap *map) {
  for (int i = 0; i < map->capacity; i++) {
    Node *entry = map->table[i];
    while (entry) {
      printf("yes\n");
      entry = entry->next;
    }
    printf("no\n");    
  }
}


int main() {

  hashmap *newMap = createMap();

  insertNode(newMap, "chanh", 12);

  displayMap(newMap);
  
  freeMap(newMap);
  
  return EXIT_SUCCESS;  
}  
